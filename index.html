<html>
<head>
  <link href="data:image/x-icon;base64,AAABAAEAEBAQAAEABAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAX9nZAEqWlgB1//8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACIiIiIiAAAAIzMzMyEgAAAjMzMzIRIAACMzMzMhESAAIzMzMyEREgAjMzMzIiIiACMzMzMzMzIAIzMzMzMzMgAjMzMzMzMyACMzMzMzMzIAIzMzMzMzMgAjMzMzMzMyACMzMzMzMzIAIiIiIiIiIgAAAAAAAAAAD//wAAgB8AAIAPAACABwAAgAMAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAD//wAA" rel="icon" type="image/x-icon">
  <title>Notepad</title>
  <style>
    body#editor {
      color: #FFF;
      background-color: #999;
      font-size: .9rem;
      font-family: Courier;
      line-height: 1.4;
      max-width: 200rem;
      margin: 0 auto;
      padding: 1rem;
    }
    img {
      max-width: 100%;
      display: block;
      margin: 0.5rem 0;
    }
  </style>
</head>
<body id="editor" contenteditable spellcheck="false">
  <div><br></div>

  <script>
    document.getElementById('editor').addEventListener('paste', function (e) {
      e.preventDefault();
      const clipboardData = e.clipboardData || window.clipboardData;
      const items = clipboardData.items;

      for (let i = 0; i < items.length; i++) {
        const item = items[i];

        if (item.kind === 'string') {
          item.getAsString(function (text) {
            const selection = window.getSelection();
            if (!selection.rangeCount) return;
            selection.deleteFromDocument();
            selection.getRangeAt(0).insertNode(document.createTextNode(text));
            selection.collapseToEnd();
          });
        }

        if (item.kind === 'file' && item.type.startsWith('image/')) {
          const file = item.getAsFile();
          const reader = new FileReader();
          reader.onload = function (event) {
            const img = document.createElement('img');
            img.src = event.target.result;
            const selection = window.getSelection();
            if (!selection.rangeCount) return;
            const range = selection.getRangeAt(0);
            range.deleteContents();
            range.insertNode(img);
            selection.collapseToEnd();
          };
          reader.readAsDataURL(file);
        }
      }
    });
  </script>
</body>
</html>
